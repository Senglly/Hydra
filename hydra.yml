dsn: ${DSN}

serve:
  public:
    port: 4444
    host: 0.0.0.0
    cors:
      enabled: true
      allowed_origins:
        - https://gateway-production-7363.up.railway.app
      allowed_methods:
        - POST
        - GET
        - PUT
        - PATCH
        - DELETE
        - OPTIONS  # Add OPTIONS for CORS preflight
      allowed_headers:
        - Authorization
        - Content-Type
        - Cookie
      exposed_headers:
        - Content-Type
        - Set-Cookie
      allow_credentials: true
  admin:
    port: 4445
    host: 0.0.0.0

urls:
  self:
    issuer: https://hydra-production-6c25.up.railway.app/
  login: https://gateway-production-7363.up.railway.app/login
  consent: https://gateway-production-7363.up.railway.app/consent
  logout: https://gateway-production-7363.up.railway.app/logout
  error: https://gateway-production-7363.up.railway.app/error
  post_logout_callback: https://gateway-production-7363.up.railway.app  # ← Add this

secrets:
  system:
    - ${SECRETS_SYSTEM}
  cookie:
    - ${SECRETS_COOKIE}

oauth2:
  expose_internal_errors: false
  allowed_top_level_claims:
    - email
    - email_verified
    - name
    - picture
  hashers:  # ← Add for better security
    algorithm: bcrypt
    bcrypt:
      cost: 10

ttl:
  login_consent_request: 1h
  access_token: 1h
  refresh_token: 720h
  id_token: 1h
  auth_code: 10m

oidc:  # ← Add OIDC specific config
  subject_identifiers:
    supported_types:
      - public
      - pairwise
    pairwise:
      salt: ${OIDC_SUBJECT_SALT}  # Add this env var

log:
  level: debug
  format: json